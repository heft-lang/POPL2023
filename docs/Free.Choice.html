<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Free.Choice</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Free.Choice.html" class="Module">Free.Choice</a> <a id="20" class="Keyword">where</a>

<a id="27" class="Keyword">open</a> <a id="32" class="Keyword">import</a> <a id="39" href="Function.html" class="Module">Function</a>
<a id="48" class="Keyword">open</a> <a id="53" class="Keyword">import</a> <a id="60" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.List.html" class="Module">Data.List</a> <a id="137" class="Keyword">hiding</a> <a id="144" class="Symbol">(</a><a id="145" href="Data.List.Base.html#4648" class="Function">or</a><a id="147" class="Symbol">)</a>

<a id="150" class="Keyword">open</a> <a id="155" class="Keyword">import</a> <a id="162" href="Free.html" class="Module">Free</a>

<a id="168" class="Comment">{- Operation -}</a>

<a id="185" class="Keyword">data</a> <a id="ChoiceOp"></a><a id="190" href="Free.Choice.html#190" class="Datatype">ChoiceOp</a> <a id="199" class="Symbol">:</a> <a id="201" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="205" class="Keyword">where</a>
  <a id="ChoiceOp.or"></a><a id="213" href="Free.Choice.html#213" class="InductiveConstructor">or</a>   <a id="218" class="Symbol">:</a> <a id="220" href="Free.Choice.html#190" class="Datatype">ChoiceOp</a>
  <a id="ChoiceOp.fail"></a><a id="231" href="Free.Choice.html#231" class="InductiveConstructor">fail</a> <a id="236" class="Symbol">:</a> <a id="238" href="Free.Choice.html#190" class="Datatype">ChoiceOp</a>


<a id="249" class="Comment">{- Effect -}</a>

<a id="Choice"></a><a id="263" href="Free.Choice.html#263" class="Function">Choice</a> <a id="270" class="Symbol">:</a> <a id="272" href="Free.html#787" class="Record">Effect</a>
<a id="279" href="Free.html#816" class="Field">Op</a>  <a id="283" href="Free.Choice.html#263" class="Function">Choice</a> <a id="290" class="Symbol">=</a> <a id="292" href="Free.Choice.html#190" class="Datatype">ChoiceOp</a>
<a id="301" href="Free.html#836" class="Field">Ret</a> <a id="305" href="Free.Choice.html#263" class="Function">Choice</a> <a id="312" href="Free.Choice.html#213" class="InductiveConstructor">or</a> <a id="315" class="Symbol">=</a> <a id="317" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="322" href="Free.html#836" class="Field">Ret</a> <a id="326" href="Free.Choice.html#263" class="Function">Choice</a> <a id="333" href="Free.Choice.html#231" class="InductiveConstructor">fail</a> <a id="338" class="Symbol">=</a> <a id="340" href="Data.Empty.html#886" class="Function">⊥</a>


<a id="344" class="Comment">{- Smart constructor -}</a>

<a id="‵or"></a><a id="369" href="Free.Choice.html#369" class="Function">‵or</a> <a id="373" class="Symbol">:</a> <a id="375" class="Symbol">⦃</a> <a id="377" href="Free.html#882" class="Generalizable">Δ</a> <a id="379" href="Free.html#3485" class="Datatype Operator">∼</a> <a id="381" href="Free.Choice.html#263" class="Function">Choice</a> <a id="388" href="Free.html#3485" class="Datatype Operator">▸</a> <a id="390" href="Free.html#884" class="Generalizable">Δ′</a> <a id="393" class="Symbol">⦄</a> <a id="395" class="Symbol">→</a> <a id="397" href="Free.html#1508" class="Datatype">Free</a> <a id="402" href="Free.html#882" class="Generalizable">Δ</a> <a id="404" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="409" href="Free.Choice.html#369" class="Function">‵or</a> <a id="413" class="Symbol">⦃</a> <a id="415" href="Free.Choice.html#415" class="Bound">w</a> <a id="417" class="Symbol">⦄</a> <a id="419" class="Symbol">=</a> <a id="421" href="Free.html#1612" class="InductiveConstructor">impure</a> <a id="428" class="Symbol">(</a><a id="429" href="Free.html#4103" class="Function">inj▸ₗ</a> <a id="435" href="Free.Choice.html#213" class="InductiveConstructor">or</a><a id="437" class="Symbol">)</a> <a id="439" class="Symbol">(</a><a id="440" href="Free.html#1550" class="InductiveConstructor">pure</a> <a id="445" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="447" href="Free.html#4325" class="Function">proj-ret▸ₗ</a> <a id="458" class="Symbol">⦃</a> <a id="460" href="Free.Choice.html#415" class="Bound">w</a> <a id="462" class="Symbol">⦄)</a>

<a id="‵fail"></a><a id="466" href="Free.Choice.html#466" class="Function">‵fail</a> <a id="472" class="Symbol">:</a> <a id="474" class="Symbol">⦃</a> <a id="476" href="Free.html#882" class="Generalizable">Δ</a> <a id="478" href="Free.html#3485" class="Datatype Operator">∼</a> <a id="480" href="Free.Choice.html#263" class="Function">Choice</a> <a id="487" href="Free.html#3485" class="Datatype Operator">▸</a> <a id="489" href="Free.html#884" class="Generalizable">Δ′</a> <a id="492" class="Symbol">⦄</a> <a id="494" class="Symbol">→</a> <a id="496" href="Free.html#1508" class="Datatype">Free</a> <a id="501" href="Free.html#882" class="Generalizable">Δ</a> <a id="503" href="Free.html#469" class="Generalizable">A</a>
<a id="505" href="Free.Choice.html#466" class="Function">‵fail</a> <a id="511" class="Symbol">⦃</a> <a id="513" href="Free.Choice.html#513" class="Bound">w</a> <a id="515" class="Symbol">⦄</a> <a id="517" class="Symbol">=</a> <a id="519" href="Free.html#1612" class="InductiveConstructor">impure</a> <a id="526" class="Symbol">(</a><a id="527" href="Free.html#4103" class="Function">inj▸ₗ</a> <a id="533" href="Free.Choice.html#231" class="InductiveConstructor">fail</a><a id="537" class="Symbol">)</a> <a id="539" class="Symbol">(</a><a id="540" href="Data.Empty.html#1041" class="Function">⊥-elim</a> <a id="547" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="549" href="Free.html#4325" class="Function">proj-ret▸ₗ</a> <a id="560" class="Symbol">⦃</a> <a id="562" href="Free.Choice.html#513" class="Bound">w</a> <a id="564" class="Symbol">⦄)</a>


<a id="569" class="Comment">{- Handler -}</a>

<a id="hChoice"></a><a id="584" href="Free.Choice.html#584" class="Function">hChoice</a> <a id="592" class="Symbol">:</a> <a id="594" href="Free.html#7015" class="Record Operator">⟨</a> <a id="596" href="Free.html#469" class="Generalizable">A</a> <a id="598" href="Free.html#7015" class="Record Operator">!</a> <a id="600" href="Free.Choice.html#263" class="Function">Choice</a> <a id="607" href="Free.html#7015" class="Record Operator">⇒</a> <a id="609" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="611" href="Free.html#7015" class="Record Operator">⇒</a> <a id="613" class="Symbol">(</a><a id="614" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="619" href="Free.html#469" class="Generalizable">A</a><a id="620" class="Symbol">)</a> <a id="622" href="Free.html#7015" class="Record Operator">!</a> <a id="624" href="Free.html#884" class="Generalizable">Δ′</a> <a id="627" href="Free.html#7015" class="Record Operator">⟩</a>
<a id="629" href="Free.html#7106" class="Field">ret</a> <a id="633" href="Free.Choice.html#584" class="Function">hChoice</a> <a id="641" href="Free.Choice.html#641" class="Bound">x</a> <a id="643" class="Symbol">_</a> <a id="645" class="Symbol">=</a> <a id="647" href="Free.html#1550" class="InductiveConstructor">pure</a> <a id="652" href="Data.List.Base.html#5040" class="Function Operator">[</a> <a id="654" href="Free.Choice.html#641" class="Bound">x</a> <a id="656" href="Data.List.Base.html#5040" class="Function Operator">]</a>
<a id="658" href="Free.html#7140" class="Field">hdl</a> <a id="662" href="Free.Choice.html#584" class="Function">hChoice</a> <a id="670" href="Free.Choice.html#213" class="InductiveConstructor">or</a> <a id="673" href="Free.Choice.html#673" class="Bound">k</a> <a id="675" href="Free.Choice.html#675" class="Bound">p</a> <a id="677" class="Symbol">=</a> <a id="679" class="Keyword">do</a>
  <a id="684" href="Free.Choice.html#684" class="Bound">l₁</a> <a id="687" href="Free.html#2048" class="Function Operator">←</a> <a id="689" href="Free.Choice.html#673" class="Bound">k</a> <a id="691" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="696" href="Free.Choice.html#675" class="Bound">p</a>
  <a id="700" href="Free.Choice.html#700" class="Bound">l₂</a> <a id="703" href="Free.html#2048" class="Function Operator">←</a> <a id="705" href="Free.Choice.html#673" class="Bound">k</a> <a id="707" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="713" href="Free.Choice.html#675" class="Bound">p</a>
  <a id="717" href="Free.html#1550" class="InductiveConstructor">pure</a> <a id="722" class="Symbol">(</a><a id="723" href="Free.Choice.html#684" class="Bound">l₁</a> <a id="726" href="Data.List.Base.html#1825" class="Function Operator">++</a> <a id="729" href="Free.Choice.html#700" class="Bound">l₂</a><a id="731" class="Symbol">)</a>
<a id="733" href="Free.html#7140" class="Field">hdl</a> <a id="737" href="Free.Choice.html#584" class="Function">hChoice</a> <a id="745" href="Free.Choice.html#231" class="InductiveConstructor">fail</a> <a id="750" href="Free.Choice.html#750" class="Bound">k</a> <a id="752" class="Symbol">_</a> <a id="754" class="Symbol">=</a> <a id="756" href="Free.html#1550" class="InductiveConstructor">pure</a> <a id="761" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
</pre></body></html>